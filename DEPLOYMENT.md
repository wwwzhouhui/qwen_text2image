# ðŸš€ Qwen Text2Image æ’ä»¶éƒ¨ç½²æŒ‡å—

## ðŸ“‹ éƒ¨ç½²å‰å‡†å¤‡

### 1. çŽ¯å¢ƒè¦æ±‚

- Python 3.12+
- Dify å¹³å°çŽ¯å¢ƒ
- ç¨³å®šçš„ç½‘ç»œè¿žæŽ¥ï¼ˆèƒ½è®¿é—® ModelScope APIï¼‰

### 2. èŽ·å– ModelScope API Key

1. è®¿é—® [ModelScope å®˜ç½‘](https://modelscope.cn)
2. æ³¨å†Œå¹¶ç™»å½•è´¦æˆ·
3. å‰å¾€ [æˆ‘çš„è®¿é—®ä»¤ç‰Œ](https://modelscope.cn/my/myaccesstoken)
4. åˆ›å»ºæ–°çš„ API Keyï¼ˆæ ¼å¼ï¼š`ms-xxxxxxxxxxxxxx`ï¼‰
5. ç¡®ä¿ API Key æœ‰å›¾åƒç”Ÿæˆæƒé™

## ðŸ”§ æœ¬åœ°æµ‹è¯•

### 1. å®‰è£…ä¾èµ–

```bash
cd qwen_text2image_plugin
pip install -r requirements.txt
```

### 2. è®¾ç½®çŽ¯å¢ƒå˜é‡

```bash
export MODELSCOPE_API_KEY=ms-your-actual-api-key
```

### 3. è¿è¡Œæµ‹è¯•è„šæœ¬

```bash
python test_plugin.py
```

é¢„æœŸè¾“å‡ºï¼š
```
ðŸ”§ Qwen Text2Image æ’ä»¶æµ‹è¯•å·¥å…·
==================================================
âœ… ä¾èµ–æ£€æŸ¥é€šè¿‡
ðŸš€ å¼€å§‹æµ‹è¯• Qwen Text2Image æ’ä»¶...
ðŸ“ ä½¿ç”¨ API Key: ms-xxxxxxx...
ðŸŽ¨ æµ‹è¯•æç¤ºè¯: ä¸€åªå¯çˆ±çš„æ©™è‰²å°çŒ«ååœ¨ç»¿è‰²çš„è‰åœ°ä¸Šï¼ŒèƒŒæ™¯æ˜¯è“å¤©ç™½äº‘
ðŸ¤– ä½¿ç”¨æ¨¡åž‹: Qwen/Qwen-Image
==================================================
[1] ðŸ“„ ðŸš€ æ­£åœ¨æäº¤å›¾åƒç”Ÿæˆä»»åŠ¡...
[2] ðŸ“„ âœ… ä»»åŠ¡å·²åˆ›å»ºï¼ŒID: task_xxxxx
[3] ðŸ“„ â³ æ­£åœ¨ç”Ÿæˆå›¾åƒï¼Œè¯·ç¨å€™...
...
[N] ðŸ–¼ï¸  å›¾åƒç”ŸæˆæˆåŠŸï¼
     ðŸ“Š å›¾åƒå¤§å°: 245760 å­—èŠ‚
     ðŸ“‹ MIME ç±»åž‹: image/png
     ðŸ’¾ å›¾åƒå·²ä¿å­˜ä¸º: test_output.png

âœ… æµ‹è¯•æˆåŠŸï¼æ’ä»¶å·¥ä½œæ­£å¸¸ã€‚
```

## ðŸ“¦ Dify å¹³å°éƒ¨ç½²

### æ–¹æ³•ä¸€ï¼šæœ¬åœ°å¼€å‘æ¨¡å¼

1. **é…ç½®çŽ¯å¢ƒæ–‡ä»¶**
   ```bash
   cp .env.example .env
   # ç¼–è¾‘ .env æ–‡ä»¶ï¼Œé…ç½®è¿œç¨‹å®‰è£…å‚æ•°
   ```

2. **å¯åŠ¨å¼€å‘æœåŠ¡å™¨**
   ```bash
   python main.py
   ```

3. **åœ¨ Dify ä¸­æ·»åŠ æ’ä»¶**
   - è¿›å…¥ Dify ç®¡ç†ç•Œé¢
   - é€‰æ‹©"æ’ä»¶ç®¡ç†"
   - æ·»åŠ æœ¬åœ°å¼€å‘æ’ä»¶
   - è¾“å…¥å¼€å‘æœåŠ¡å™¨åœ°å€

### æ–¹æ³•äºŒï¼šæ’ä»¶åŒ…éƒ¨ç½²

1. **æ‰“åŒ…æ’ä»¶**
   ```bash
   # åˆ›å»ºæ’ä»¶åŽ‹ç¼©åŒ…
   tar -czf qwen_text2image_plugin.tar.gz qwen_text2image_plugin/
   ```

2. **ä¸Šä¼ åˆ° Dify**
   - åœ¨ Dify ç®¡ç†ç•Œé¢é€‰æ‹©"æ’ä»¶ç®¡ç†"
   - ç‚¹å‡»"ä¸Šä¼ æ’ä»¶"
   - é€‰æ‹©æ‰“åŒ…çš„æ’ä»¶æ–‡ä»¶
   - ç­‰å¾…å®‰è£…å®Œæˆ

3. **é…ç½®æ’ä»¶**
   - åœ¨æ’ä»¶åˆ—è¡¨ä¸­æ‰¾åˆ°"Qwen æ–‡ç”Ÿå›¾"
   - ç‚¹å‡»"é…ç½®"
   - è¾“å…¥ ModelScope API Key
   - ä¿å­˜é…ç½®

## âš™ï¸ é…ç½®è¯´æ˜Ž

### å¿…éœ€é…ç½®

| é…ç½®é¡¹ | è¯´æ˜Ž | ç¤ºä¾‹ |
|--------|------|------|
| ModelScope API Key | ç”¨äºŽè°ƒç”¨ ModelScope API | `ms-xxxxxxxxxxxxxx` |

### å¯é€‰é…ç½®

| é…ç½®é¡¹ | é»˜è®¤å€¼ | è¯´æ˜Ž |
|--------|--------|------|
| è¶…æ—¶æ—¶é—´ | 300ç§’ | å›¾åƒç”Ÿæˆæœ€å¤§ç­‰å¾…æ—¶é—´ |
| è½®è¯¢é—´éš” | 5ç§’ | ä»»åŠ¡çŠ¶æ€æŸ¥è¯¢é—´éš” |
| æœ€å¤§é‡è¯•æ¬¡æ•° | 60æ¬¡ | æœ€å¤§è½®è¯¢æ¬¡æ•° |

## ðŸ” éªŒè¯éƒ¨ç½²

### 1. æ’ä»¶çŠ¶æ€æ£€æŸ¥

åœ¨ Dify æ’ä»¶ç®¡ç†ç•Œé¢ç¡®è®¤ï¼š
- âœ… æ’ä»¶çŠ¶æ€ä¸º"å·²å¯ç”¨"
- âœ… API Key é…ç½®æ­£ç¡®
- âœ… æ²¡æœ‰é”™è¯¯æç¤º

### 2. åŠŸèƒ½æµ‹è¯•

1. **åˆ›å»ºæµ‹è¯•å·¥ä½œæµ**
   - æ–°å»ºä¸€ä¸ªç®€å•çš„å·¥ä½œæµ
   - æ·»åŠ "Qwen æ–‡ç”Ÿå›¾"å·¥å…·
   - é…ç½®æµ‹è¯•æç¤ºè¯

2. **è¿è¡Œæµ‹è¯•**
   ```
   æç¤ºè¯: ä¸€æœµçº¢è‰²çš„çŽ«ç‘°èŠ±
   æ¨¡åž‹: Qwen/Qwen-Image
   ```

3. **éªŒè¯ç»“æžœ**
   - æ£€æŸ¥æ˜¯å¦æˆåŠŸç”Ÿæˆå›¾åƒ
   - éªŒè¯å›¾åƒè´¨é‡å’Œå†…å®¹
   - ç¡®è®¤å¤„ç†æ—¶é—´åˆç†

## ðŸš¨ æ•…éšœæŽ’é™¤

### å¸¸è§é—®é¢˜

1. **æ’ä»¶åŠ è½½å¤±è´¥**
   ```
   é”™è¯¯: æ— æ³•åŠ è½½æ’ä»¶
   è§£å†³: æ£€æŸ¥ manifest.yaml æ ¼å¼å’Œä¾èµ–å®‰è£…
   ```

2. **API Key éªŒè¯å¤±è´¥**
   ```
   é”™è¯¯: ModelScope API key æ ¼å¼é”™è¯¯
   è§£å†³: ç¡®è®¤ API Key ä»¥ 'ms-' å¼€å¤´ä¸”é•¿åº¦æ­£ç¡®
   ```

3. **å›¾åƒç”Ÿæˆè¶…æ—¶**
   ```
   é”™è¯¯: å›¾åƒç”Ÿæˆè¶…æ—¶ï¼ˆ5åˆ†é’Ÿï¼‰
   è§£å†³: æ£€æŸ¥ç½‘ç»œè¿žæŽ¥ï¼Œç®€åŒ–æç¤ºè¯ï¼Œæˆ–å¢žåŠ è¶…æ—¶æ—¶é—´
   ```

4. **ç½‘ç»œè¿žæŽ¥é—®é¢˜**
   ```
   é”™è¯¯: ç½‘ç»œè¯·æ±‚é”™è¯¯
   è§£å†³: æ£€æŸ¥é˜²ç«å¢™è®¾ç½®ï¼Œç¡®ä¿èƒ½è®¿é—® api-inference.modelscope.cn
   ```

### è°ƒè¯•æ¨¡å¼

å¯ç”¨è¯¦ç»†æ—¥å¿—ï¼š
```python
import logging
logging.basicConfig(level=logging.DEBUG)
```

### æ€§èƒ½ä¼˜åŒ–

1. **å†…å­˜ä¼˜åŒ–**
   - åŠæ—¶é‡Šæ”¾å›¾åƒæ•°æ®
   - é¿å…åŒæ—¶å¤„ç†å¤šä¸ªå¤§å›¾åƒ

2. **ç½‘ç»œä¼˜åŒ–**
   - ä½¿ç”¨ç¨³å®šçš„ç½‘ç»œè¿žæŽ¥
   - è€ƒè™‘è®¾ç½®ä»£ç†ï¼ˆå¦‚éœ€è¦ï¼‰

## ðŸ“Š ç›‘æŽ§å’Œç»´æŠ¤

### æ€§èƒ½æŒ‡æ ‡

- å¹³å‡ç”Ÿæˆæ—¶é—´ï¼š30-120ç§’
- æˆåŠŸçŽ‡ï¼š>95%
- å†…å­˜ä½¿ç”¨ï¼š<100MB

### å®šæœŸç»´æŠ¤

1. **æ›´æ–°ä¾èµ–**
   ```bash
   pip install --upgrade -r requirements.txt
   ```

2. **æ£€æŸ¥ API é™åˆ¶**
   - ç›‘æŽ§ API è°ƒç”¨é¢‘çŽ‡
   - å…³æ³¨ ModelScope æœåŠ¡çŠ¶æ€

3. **å¤‡ä»½é…ç½®**
   - å®šæœŸå¤‡ä»½æ’ä»¶é…ç½®
   - è®°å½•é‡è¦çš„é…ç½®å˜æ›´

## ðŸ”— ç›¸å…³èµ„æº

- [ModelScope API æ–‡æ¡£](https://modelscope.cn/docs)
- [Dify æ’ä»¶å¼€å‘æ–‡æ¡£](https://docs.dify.ai)
- [é—®é¢˜åé¦ˆ](https://github.com/your-repo/issues)

---

å¦‚æœ‰é—®é¢˜ï¼Œè¯·å‚è€ƒæ•…éšœæŽ’é™¤éƒ¨åˆ†æˆ–è”ç³»æŠ€æœ¯æ”¯æŒã€‚